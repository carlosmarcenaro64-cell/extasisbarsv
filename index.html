<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extasis Bar-Motel</title>
    
    <!-- 1. Cargamos Tailwind CSS (con plugin de formularios) -->
    <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
    
    <!-- 2. Definimos tus colores personalizados -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'extasis-purple': '#9A00FF',
                        'extasis-black': '#111111',
                        'extasis-gray': '#1c1c1c',
                    },
                    fontFamily: {
                        'sans': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <!-- 3. SCRIPTS DE FIREBASE (El siguiente paso) -->
    <!-- Dejamos el espacio para conectar Firebase más adelante -->
    <!-- 
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot, collection }...
    
        // TODO: Add YOUR Firebase Configuration
        const firebaseConfig = { ... };

        // Initialize Firebase
        // const app = initializeApp(firebaseConfig);
        // const auth = getAuth(app);
        // const db = getFirestore(app);
    </script>
    -->

    <!-- 4. Estilos CSS Personalizados (Efecto Glitch, Mesas, Scrollbars) -->
    <style type="text/css">
        body {
            font-family: 'Inter', sans-serif;
        }
        .glow-shadow {
            box-shadow: 0 4px 30px rgba(154, 0, 255, 0.2);
        }
        /* Ocultar scrollbars en las listas de pedidos */
        #lista-consumo-total::-webkit-scrollbar,
        #lista-carrito::-webkit-scrollbar {
            display: none;
        }
        #lista-consumo-total,
        #lista-carrito {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* Estilo para las mesas */
        .table-box {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .table-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(154, 0, 255, 0.3);
        }

        /* --- ESTILOS PARA EFECTO GLITCH --- */
        .glitch-wrapper {
            position: relative;
        }

        .glitch {
            position: relative;
            z-index: 1;
        }

        .glitch::before,
        .glitch::after {
            content: attr(data-text); /* Toma el texto del atributo data-text */
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
        }

        .glitch::before {
            left: 2px;
            text-shadow: -2px 0 #ff00c1; /* Color del glitch (magenta) */
            animation: glitch-anim-1 2s infinite linear alternate-reverse;
        }

        .glitch::after {
            left: -2px;
            text-shadow: -2px 0 #00fff9; /* Color del glitch (cian) */
            animation: glitch-anim-2 2s infinite linear alternate-reverse;
        }

        @keyframes glitch-anim-1 {
            0% { clip-path: polygon(0 2%, 100% 2%, 100% 5%, 0 5%); }
            10% { clip-path: polygon(0 15%, 100% 15%, 100% 15%, 0 15%); }
            20% { clip-path: polygon(0 10%, 100% 10%, 100% 20%, 0 20%); }
            30% { clip-path: polygon(0 30%, 100% 30%, 100% 30%, 0 30%); }
            40% { clip-path: polygon(0 25%, 100% 25%, 100% 30%, 0 30%); }
            50% { clip-path: polygon(0 50%, 100% 50%, 100% 55%, 0 55%); }
            60% { clip-path: polygon(0 70%, 100% 70%, 100% 70%, 0 70%); }
            70% { clip-path: polygon(0 90%, 100% 90%, 100% 95%, 0 95%); }
            80% { clip-path: polygon(0 60%, 100% 60%, 100% 65%, 0 65%); }
            90% { clip-path: polygon(0 80%, 100% 80%, 100% 80%, 0 80%); }
            100% { clip-path: polygon(0 50%, 100% 50%, 100% 55%, 0 55%); }
        }

        @keyframes glitch-anim-2 {
            0% { clip-path: polygon(0 5%, 100% 5%, 100% 10%, 0 10%); }
            10% { clip-path: polygon(0 20%, 100% 20%, 100% 20%, 0 20%); }
            20% { clip-path: polygon(0 35%, 100% 35%, 100% 40%, 0 40%); }
            30% { clip-path: polygon(0 50%, 100% 50%, 100% 50%, 0 50%); }
            40% { clip-path: polygon(0 45%, 100% 45%, 100% 50%, 0 50%); }
            50% { clip-path: polygon(0 60%, 100% 60%, 100% 65%, 0 65%); }
            60% { clip-path: polygon(0 80%, 100% 80%, 100% 80%, 0 80%); }
            70% { clip-path: polygon(0 60%, 100% 60%, 100% 65%, 0 65%); }
            80% { clip-path: polygon(0 40%, 100% 40%, 100% 45%, 0 45%); }
            90% { clip-path: polygon(0 70%, 100% 70%, 100% 70%, 0 70%); }
            100% { clip-path: polygon(0 90%, 100% 90%, 100% 95%, 0 95%); }
        }
        /* --- FIN DE ESTILOS GLITCH --- */
    </style>
</head>

<body class="bg-extasis-black text-white">

    <!-- BARRA DE NAVEGACIÓN PRINCIPAL -->
    <nav id="navbar-main" class="bg-extasis-black/80 backdrop-blur-md sticky top-0 z-50 shadow-lg shadow-extasis-purple/10">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center h-20">
                <!-- Logo -->
                <a href="#inicio" id="logo-btn" class="text-3xl font-bold text-extasis-purple drop-shadow-[0_2px_2px_rgba(0,0,0,0.5)]">
                    EXTASIS
                </a>
                
                <!-- Menú de Navegación (para pantallas grandes) -->
                <div class="hidden md:flex space-x-8 text-lg items-center">
                    <a href="#inicio" class="hover:text-extasis-purple transition-colors">Inicio</a>
                    <a href="motel.html" class"hover:text-extasis-purple transition-colors">Motel</a>
                    <a href="#programacion" class="hover:text-extasis-purple transition-colors">Discoteca</a>
                    <a href="#menu" class="hover:text-extasis-purple transition-colors">Menú</a>
                    <!-- BOTÓN DE LOGIN -->
                    <button id="show-login-btn" class="bg-extasis-purple text-white font-bold py-2 px-6 rounded-lg hover:bg-purple-700 transition-colors shadow-lg glow-shadow">
                        Login
                    </button>
                </div>
                
                <!-- Botón (para pantallas pequeñas) -->
                <button id="mobile-menu-btn" class="md:hidden text-white text-3xl">
                    ☰
                </button>
            </div>
        </div>
        <!-- Menú Móvil (oculto por defecto) -->
        <div id="mobile-menu" class="hidden md:hidden bg-extasis-gray text-center">
            <a href="#inicio" class="block py-3 px-4 text-lg hover:bg-extasis-purple">Inicio</a>
            <a href="motel.html" class="block py-3 px-4 text-lg hover:bg-extasis-purple">Motel</a>
            <a href="#programacion" class="block py-3 px-4 text-lg hover:bg-extasis-purple">Discoteca</a>
            <a href="#menu" class="block py-3 px-4 text-lg hover:bg-extasis-purple">Menú</a>
        </div>
    </nav>

    <!-- ====================================================== -->
    <!--            PÁGINA PÚBLICA (Lo que todos ven)           -->
    <!-- ====================================================== -->
    <main id="public-site">

        <!-- SECCIÓN INICIO (HERO) -->
        <section id="inicio" class="h-screen flex items-center justify-center text-center bg-cover bg-center" style="background-image: linear-gradient(rgba(17, 17, 17, 0.7), rgba(17, 17, 17, 0.7)), url('https://placehold.co/1920x1080/111111/9A00FF?text=Extasis');">
            <div class="p-4">
                <!-- Título con efecto Glitch -->
                <div classT="glitch-wrapper">
                    <h1 class="glitch text-7xl md:text-9xl font-bold text-white drop-shadow-lg" data-text="EXTASIS">
                        EXTASIS
                    </h1>
                </div>
                <h2 class="text-4xl md:text-5xl font-light text-gray-200 mt-4 mb-10">Bar - Motel</h2>
                <p class="text-xl md:text-2xl text-gray-300 max-w-2xl mx-auto mb-12">
                    La noche tiene un nuevo significado. Tu QR es la llave.
                </p>
                <!-- Botones de Acción -->
                <div class="flex flex-col md:flex-row justify-center gap-6">
                    <button id="enter-app-btn" class="bg-extasis-purple text-white text-xl font-bold py-4 px-10 rounded-lg hover:bg-purple-700 transition-colors shadow-lg glow-shadow">
                        Ingresar a Discoteca (QR)
                    </button>
                    <a href="motel.html" class="bg-transparent border-2 border-white text-white text-xl font-bold py-4 px-10 rounded-lg hover:bg-white hover:text-extasis-black transition-colors">
                        Reservar Motel
                    </a>
                </div>
            </div>
        </section>

        <!-- SECCIÓN PROGRAMACIÓN (DISCOTECA) -->
        <section id="programacion" class="py-24 bg-extasis-gray">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-5xl font-bold mb-4">Agenda Semanal</h2>
                <p class="text-xl text-gray-300 mb-12">El soundtrack de tu noche.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Día 1 -->
                    <div class="bg-extasis-black p-8 rounded-lg shadow-lg glow-shadow">
                        <h3 class="text-3xl font-bold text-extasis-purple mb-4">Jueves de Neón</h3>
                        <p class="text-lg mb-4">DJ Residente: ZKRD</p>
                        <p class="text-gray-400">Reggaetón y Electrónica. 2x1 en Cócteles Morados.</p>
                    </div>
                    <!-- Día 2 -->
                    <div class="bg-extasis-black p-8 rounded-lg shadow-lg glow-shadow">
                        <h3 class="text-3xl font-bold text-extasis-purple mb-4">Viernes VIP</h3>
                        <p class="text-lg mb-4">DJ Invitado: ARODI</p>
                        <p class="text-gray-400">Hip-Hop y R&B. Botellas $50 antes de las 11 PM.</p>
                    </div>
                    <!-- Día 3 -->
                    <div class="bg-extasis-black p-8 rounded-lg shadow-lg glow-shadow">
                        <h3 class="text-3xl font-bold text-extasis-purple mb-4">Sábado Extasis</h3>
                        <p class="text-lg mb-4">Show de Media Noche</p>
                        <p class="text-gray-400">Todos los hits. La noche principal. Sorpresas y shows.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECCIÓN MENÚ (PÚBLICO) -->
        <section id="menu" class="py-24 bg-extasis-black">
            <div class="container mx-auto px-4">
                <h2 class="text-5xl font-bold text-center mb-12">El Menú</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-16">
                    
                    <!-- Columna de Comidas -->
                    <div>
                        <h3 class="text-4xl font-bold text-extasis-purple mb-8 border-b-2 border-extasis-purple pb-2">Comidas</h3>
                        <ul class="space-y-4 text-lg">
                            <li class="flex justify-between"><span class="font-semibold">Alitas BBQ/Búfalo (12)</span> <span>$12.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Nachos Extasis (Carne, Pollo)</span> <span>$10.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Quesadillas (Pollo, Queso)</span> <span>$8.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Tacos (Asada, Pastor) (3)</span> <span>$7.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Mini Hamburguesas (4)</span> <span>$11.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Papas Fritas c/ Queso y Tocino</span> <span>$6.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Dedos de Queso</span> <span>$7.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Ceviche Frito</span> <span>$9.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Pizza Personal (Peperoni)</span> <span>$8.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Bao Buns (Cerdo) (2)</span> <span>$7.50</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Brochetas de Pollo</span> <span>$8.50</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Sushi Roll (California)</span> <span>$9.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Aros de Cebolla</span> <span>$5.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Empanadas (Carne) (3)</span> <span>$6.50</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Tabla de Quesos y Jamones</span> <span>$15.00</span></li>
                        </ul>
                    </div>

                    <!-- Columna de Bebidas -->
                    <div>
                        <!-- Sin Alcohol -->
                        <h3 class="text-4xl font-bold text-extasis-purple mb-8 border-b-2 border-extasis-purple pb-2">Bebidas</h3>
                        <h4 class="text-2xl font-semibold text-gray-200 mb-4">Sin Alcohol</h4>
                        <ul class="space-y-4 text-lg mb-8">
                            <li class="flex justify-between"><span class="font-semibold">Coca-Cola</span> <span>$2.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Pepsi</span> <span>$2.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Fanta / Uva</span> <span>$2.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Agua (Botella)</span> <span>$1.50</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Red Bull</span> <span>$4.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Jugo de Naranja</span> <span>$2.50</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Limonada</span> <span>$2.50</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Piña Colada (Sin alcohol)</span> <span>$4.00</span></li>
                        </ul>

                        <!-- Con Alcohol -->
                        <h4 class="text-2xl font-semibold text-gray-200 mb-4">Con Alcohol</h4>
                        <ul class="space-y-4 text-lg">
                            <li class="flex justify-between"><span class="font-semibold">Cerveza (Nacional)</span> <span>$3.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Cerveza (Importada)</span> <span>$4.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Margarita</span> <span>$6.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Mojito</span> <span>$6.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Gin & Tonic</span> <span>$7.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Cuba Libre (Ron)</span> <span>$5.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Whisky (Shot)</span> <span>$5.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Tequila (Shot)</span> <span>$4.00</span></li>
                            <li class="flex justify-between"><span class="font-semibold">Botella (Ron, Vodka)</span> <span>$60.00</span></li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- FOOTER -->
        <footer class="bg-extasis-gray py-12">
            <div class="container mx-auto px-4 text-center text-gray-400">
                <p>&copy; 2024 Extasis Bar-Motel. Todos los derechos reservados.</p>
            </div>
        </footer>
    </main>

    <!-- ====================================================== -->
    <!--            PANTALLA DE LOGIN (AHORA CON GOOGLE)        -->
    <!-- ====================================================== -->
    <section id="login-screen" class="hidden fixed inset-0 bg-extasis-black z-[100] flex items-center justify-center p-4">
        <div class="bg-extasis-gray p-10 rounded-lg shadow-2xl glow-shadow w-full max-w-md text-center">
            <h2 class="text-4xl font-bold mb-8 text-extasis-purple">Bienvenido</h2>
            <p class="text-lg mb-8">Escanea tu QR en la puerta o inicia sesión para ver tu mesa.</p>
            
            <!-- Botón real de Login con Google -->
            <button id="google-login-btn" class="w-full bg-white text-gray-800 text-lg font-bold py-4 px-10 rounded-lg hover:bg-gray-200 transition-colors shadow-lg flex items-center justify-center">
                <img src="https://www.google.com/images/hpp/ic_wahlberg_product_core_48.png8.png" alt="Google Logo" class="w-6 h-6 mr-4">
                Iniciar Sesión con Google
            </button>
            
            <button id="cancel-login-btn" class="mt-6 text-gray-400 hover:text-white">
                Cancelar
            </button>
        </div>
    </section>

    <!-- ====================================================== -->
    <!--            PANTALLA DE SELECCIÓN DE MESAS              -->
    <!-- ====================================================== -->
    <section id="table-selection-screen" class="hidden fixed inset-0 bg-extasis-black z-[100] flex items-center justify-center p-4">
        <div class="bg-extasis-gray p-10 rounded-lg shadow-2xl glow-shadow w-full max-w-4xl text-center">
            <h2 class="text-4xl font-bold mb-8 text-extasis-purple">Selecciona tu Mesa</h2>
            <p class="text-lg mb-6">Esta es tu mesa asignada. Haz clic para entrar.</p>
            
            <!-- Contenedor de las 12 mesas -->
            <div id="table-grid" class="grid grid-cols-3 md:grid-cols-6 gap-6 mb-8">
                <!-- Las mesas se generan aquí con JS -->
            </div>
            
            <p id="tables-full-msg" class="text-xl text-yellow-400 hidden">¡Todas las mesas están llenas! Por favor espera.</p>

            <button id="logout-from-tables-btn" class="mt-6 text-gray-400 hover:text-white">
                Cerrar Sesión
            </button>
        </div>
    </section>

    <!-- ====================================================== -->
    <!--            PANTALLA DE QR DE ENTRADA (NUEVO)           -->
    <!-- ====================================================== -->
    <section id="entry-qr-screen" class="hidden fixed inset-0 bg-extasis-black z-[100] flex items-center justify-center p-4">
        <div class="bg-white p-10 rounded-lg shadow-2xl w-full max-w-md text-center text-extasis-black">
            <h2 class="text-3xl font-bold mb-4">¡Bienvenido!</h2>
            <p class="text-lg mb-6">Muestra este QR en la entrada para que te lleven a tu mesa:</p>
            <span id="entry-qr-table-number" class="text-6xl font-bold text-extasis-purple mb-6 block">Mesa 5</span>
            <!-- Usamos un placeholder de QR -->
            <img src="https://placehold.co/400x400/111111/FFFFFF?text=Tu+QR+de+Entrada" alt="QR Code para entrar" class="w-full max-w-xs mx-auto rounded-lg mb-6">
            
            <button id="at-table-btn" class="w-full bg-extasis-purple text-white font-bold py-4 mt-4 rounded-lg hover:bg-purple-700 transition-colors">
                Estoy en mi mesa (Empezar a Pedir)
            </button>
            <button id="logout-from-qr-btn" class="mt-6 text-gray-600 hover:text-black">
                Cancelar / Cerrar Sesión
            </button>
        </div>
    </section>


    <!-- ====================================================== -->
    <!--          BARRA DE NAVEGACIÓN (DENTRO DE LA APP)        -->
    <!-- ====================================================== -->
    <nav id="navbar-app" class="hidden bg-extasis-gray sticky top-0 z-50 shadow-lg shadow-extasis-purple/10">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center h-20">
                <!-- Info de Mesa -->
                <div>
                    <span class="text-lg text-gray-400">Tu Mesa:</span>
                    <span id="app-table-number" class="text-2xl font-bold text-extasis-purple ml-2">#12</span>
                </div>
                <!-- Botón de Salir -->
                <button id="logout-btn" class="text-gray-400 font-medium py-2 px-4 rounded-lg hover:bg-extasis-black hover:text-white transition-colors">
                    Cerrar Sesión
                </button>
            </div>
        </div>
    </nav>

    <!-- ====================================================== -->
    <!--            PANTALLA DE LA APP (PEDIDOS)                -->
    <!-- ====================================================== -->
    <main id="app-screen" class="hidden min-h-screen">
        <div class="container mx-auto px-4 py-12">
            <!-- Grid de 3 columnas: Inventario, Pedido, Consumo -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                
                <!-- 1. INVENTARIO (Menú para pedir) -->
                <div class="lg:col-span-2 bg-extasis-gray p-6 rounded-lg shadow-lg">
                    <h2 class="text-3xl font-bold text-extasis-purple mb-6">Inventario</h2>
                    
                    <!-- Comidas -->
                    <h3 class="text-2xl font-semibold mb-4">Comidas</h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-8">
                        <!-- Comidas se inyectan aquí -->
                    </div>

                    <!-- Bebidas Sin Alcohol -->
                    <h3 class="text-2xl font-semibold mb-4">Bebidas (Sin Alcohol)</h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 mb-8">
                        <!-- Bebidas sin alcohol se inyectan aquí -->
                    </div>

                    <!-- Bebidas Con Alcohol -->
                    <h3 class="text-2xl font-semibold mb-4">Bebidas (Con Alcohol)</h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <!-- Bebidas con alcohol se inyectan aquí -->
                    </div>
                </div>

                <!-- 2. MI CUENTA (Columna derecha) -->
                <div class="space-y-8">
                    
                    <!-- 2.1 NUEVO PEDIDO (Carrito) -->
                    <div class="bg-extasis-gray p-6 rounded-lg shadow-lg">
                        <h2 class="text-2xl font-bold mb-4">Nuevo Pedido (Carrito)</h2>
                        <div id="lista-carrito" class="space-y-3 max-h-48 overflow-y-auto pr-2">
                            <!-- Items del carrito -->
                            <p id="carrito-vacio" class="text-gray-400">Añade items del inventario...</p>
                        </div>
                        <hr class="border-gray-700 my-4">
                        <div class="flex justify-between text-xl font-bold">
                            <span>Total Carrito:</span>
                            <span id="total-carrito">$0.00</span>
                        </div>
                        <button id="confirmar-pedido-btn" class="w-full bg-extasis-purple text-white font-bold py-3 mt-4 rounded-lg hover:bg-purple-700 transition-colors" disabled>
                            Confirmar y Enviar Pedido
                        </button>
                    </div>

                    <!-- 2.2 CONSUMO ACUMULADO -->
                    <div class="bg-extasis-gray p-6 rounded-lg shadow-lg">
                        <h2 class="text-2xl font-bold mb-4">Consumo Acumulado</h2>
                        <div id="lista-consumo-total" class="space-y-3 max-h-60 overflow-y-auto pr-2">
                            <!-- Items consumidos -->
                            <p id="consumo-vacio" class="text-gray-400">Aún no has confirmado pedidos.</p>
                        </div>
                        <hr class="border-gray-700 my-4">
                        <div class="flex justify-between text-2xl font-bold text-extasis-purple">
                            <span>TOTAL A PAGAR:</span>
                            <span id="total-consumo">$0.00</span>
                        </div>
                        <button id="pagar-btn" class="w-full bg-white text-extasis-black font-bold py-3 mt-4 rounded-lg hover:bg-gray-200 transition-colors">
                            Ver QR para Pagar en Caja
                        </button>
                    </div>

                </div>

            </div>
        </div>
    </main>

    <!-- ====================================================== -->
    <!--            PANTALLA DE PAGO (QR)                       -->
    <!-- ====================================================== -->
    <section id="payment-screen" class="hidden fixed inset-0 bg-extasis-black z-[100] flex items-center justify-center p-4">
        <div class="bg-white p-10 rounded-lg shadow-2xl w-full max-w-md text-center text-extasis-black">
            <h2 class="text-3xl font-bold mb-4">Pagar en Caja</h2>
            <p class="text-lg mb-6">Muestra este QR al cajero para pagar tu total de:</p>
            <span id="payment-total" class="text-6xl font-bold text-extasis-purple mb-6 block">$0.00</span>
            <!-- Usamos un placeholder de QR -->
            <img src="https://placehold.co/400x400/111111/FFFFFF?text=Tu+QR+de+Pago" alt="QR Code para pagar" class="w-full max-w-xs mx-auto rounded-lg mb-6">
            
            <button id="cancel-payment-btn" class="mt-4 text-gray-600 hover:text-black">
                Volver a mi mesa
            </button>
        </div>
    </section>

    <!-- ====================================================== -->
    <!--            SCRIPT DE JAVASCRIPT (LÓGICA)               -->
    <!-- ====================================================== -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- ESTADO GLOBAL (Simulación) ---
            let estadoMesas = {}; // Objeto para guardar el estado de las 12 mesas
            let mesaActual = null; // La mesa que el usuario está usando

            // Base de datos del Inventario
            const INVENTARIO = {
                comidas: [
                    { nombre: 'Alitas BBQ (12)', precio: 12.00 },
                    { nombre: 'Nachos Extasis', precio: 10.00 },
                    { nombre: 'Quesadillas', precio: 8.00 },
                    { nombre: 'Tacos (Asada) (3)', precio: 7.00 },
                    { nombre: 'Mini Burgers (4)', precio: 11.00 },
                    { nombre: 'Papas c/ Queso', precio: 6.00 },
                    { nombre: 'Dedos de Queso', precio: 7.00 },
                    { nombre: 'Ceviche Frito', precio: 9.00 },
                    { nombre: 'Pizza (Peperoni)', precio: 8.00 },
                    { nombre: 'Bao Buns (Cerdo)', precio: 7.50 },
                    { nombre: 'Brochetas de Pollo', precio: 8.50 },
                    { nombre: 'Sushi Roll', precio: 9.00 },
                    { nombre: 'Aros de Cebolla', precio: 5.00 },
                    { nombre: 'Empanadas (3)', precio: 6.50 },
                    { nombre: 'Tabla de Quesos', precio: 15.00 },
                ],
                sinAlcohol: [
                    { nombre: 'Coca-Cola', precio: 2.00 },
                    { nombre: 'Pepsi', precio: 2.00 },
                    { nombre: 'Fanta', precio: 2.00 },
                    { nombre: 'Agua', precio: 1.50 },
                    { nombre: 'Red Bull', precio: 4.00 },
                    { nombre: 'Jugo de Naranja', precio: 2.50 },
                    { nombre: 'Limonada', precio: 2.50 },
                    { nombre: 'Piña Colada (S/A)', precio: 4.00 },
                ],
                conAlcohol: [
                    { nombre: 'Cerveza Nacional', precio: 3.00 },
                    { nombre: 'Cerveza Importada', precio: 4.00 },
                    { nombre: 'Margarita', precio: 6.00 },
                    { nombre: 'Mojito', precio: 6.00 },
                    { nombre: 'Gin & Tonic', precio: 7.00 },
                    { nombre: 'Cuba Libre (Ron)', precio: 5.00 },
                    { nombre: 'Whisky (Shot)', precio: 5.00 },
                    { nombre: 'Tequila (Shot)', precio: 4.00 },
                    { nombre: 'Botella (Ron)', precio: 60.00 },
                ]
            };

            // --- ELEMENTOS DE LA PÁGINA PÚBLICA ---
            const publicSite = document.getElementById('public-site');
            const navbarMain = document.getElementById('navbar-main');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            const enterAppBtn = document.getElementById('enter-app-btn');
            const logoBtn = document.getElementById('logo-btn');

            // --- ELEMENTOS DE LOGIN Y SELECCIÓN DE MESA ---
            const loginScreen = document.getElementById('login-screen');
            const showLoginBtn = document.getElementById('show-login-btn');
            const googleLoginBtn = document.getElementById('google-login-btn');
            const cancelLoginBtn = document.getElementById('cancel-login-btn');
            const tableSelectionScreen = document.getElementById('table-selection-screen');
            const tableGrid = document.getElementById('table-grid');
            const logoutFromTablesBtn = document.getElementById('logout-from-tables-btn');
            const tablesFullMsg = document.getElementById('tables-full-msg');

            // --- NUEVO: ELEMENTOS QR DE ENTRADA ---
            const entryQrScreen = document.getElementById('entry-qr-screen');
            const entryQrTableNumber = document.getElementById('entry-qr-table-number');
            const atTableBtn = document.getElementById('at-table-btn');
            const logoutFromQrBtn = document.getElementById('logout-from-qr-btn');

            // --- ELEMENTOS DE "MI MESA" ---
            const appScreen = document.getElementById('app-screen');
            const navbarApp = document.getElementById('navbar-app');
            const appTableNumber = document.getElementById('app-table-number');
            const logoutBtn = document.getElementById('logout-btn');
            const listaCarrito = document.getElementById('lista-carrito');
            const carritoVacio = document.getElementById('carrito-vacio');
            const totalCarrito = document.getElementById('total-carrito');
            const confirmarPedidoBtn = document.getElementById('confirmar-pedido-btn');
            const listaConsumoTotal = document.getElementById('lista-consumo-total');
            const consumoVacio = document.getElementById('consumo-vacio');
            const totalConsumo = document.getElementById('total-consumo');
            const pagarBtn = document.getElementById('pagar-btn');
            const paymentScreen = document.getElementById('payment-screen');
            const paymentTotal = document.getElementById('payment-total');
            const cancelPaymentBtn = document.getElementById('cancel-payment-btn');

            // --- LÓGICA DE NAVEGACIÓN (Pública vs App) ---

            function mostrarPaginaPublica() {
                publicSite.classList.remove('hidden');
                navbarMain.classList.remove('hidden');
                loginScreen.classList.add('hidden');
                tableSelectionScreen.classList.add('hidden');
                entryQrScreen.classList.add('hidden'); // Ocultar nueva pantalla
                appScreen.classList.add('hidden');
                navbarApp.classList.add('hidden');
                paymentScreen.classList.add('hidden');
            }

            function mostrarLogin() {
                publicSite.classList.add('hidden');
                navbarMain.classList.add('hidden');
                loginScreen.classList.remove('hidden');
            }

            function mostrarSeleccionMesa() {
                loginScreen.classList.add('hidden');
                tableSelectionScreen.classList.remove('hidden');
                actualizarVistaMesas();
            }

            // MODIFICADO: Esta función ahora muestra el QR de entrada
            function reservarMesaYMostrarQR(numeroMesa) {
                mesaActual = numeroMesa;
                estadoMesas[mesaActual].estado = 'ocupada'; // Reservar la mesa

                tableSelectionScreen.classList.add('hidden');
                entryQrScreen.classList.remove('hidden'); // Mostrar pantalla QR
                
                entryQrTableNumber.textContent = `Mesa ${mesaActual}`; // Poner el número de mesa
            }

            // NUEVO: Esta función ahora muestra la app de pedidos
            function mostrarAppDePedidos() {
                entryQrScreen.classList.add('hidden'); // Ocultar pantalla QR
                appScreen.classList.remove('hidden'); // Mostrar app
                navbarApp.classList.remove('hidden');
                
                appTableNumber.textContent = `#${mesaActual}`;
                
                // Cargar el estado de la mesa (pedidos, etc.)
                actualizarVistaCarrito();
                actualizarVistaConsumo();
            }

            // --- INICIALIZACIÓN ---
            
            // 1. Inicializar el estado de las 12 mesas
            function inicializarEstadoMesas() {
                estadoMesas = {};
                for (let i = 1; i <= 12; i++) {
                    estadoMesas[i] = {
                        estado: 'libre', // 'libre', 'ocupada'
                        carrito: [],
                        consumo: []
                    };
                }
                // Simular algunas mesas ocupadas
                estadoMesas[3].estado = 'ocupada';
                estadoMesas[8].estado = 'ocupada';
            }

            // 2. Poblar el inventario en la UI de la App
            function poblarInventario() {
                const comidasContainer = appScreen.querySelector('h3:nth-of-type(1) + div');
                const sinAlcoholContainer = appScreen.querySelector('h3:nth-of-type(2) + div');
                const conAlcoholContainer = appScreen.querySelector('h3:nth-of-type(3) + div');

                const crearBotonItem = (item) => {
                    const btn = document.createElement('button');
                    btn.className = 'item-inventario text-left bg-extasis-black p-3 rounded-lg hover:bg-extasis-purple transition-colors';
                    btn.innerHTML = `
                        <span class="font-semibold">${item.nombre}</span>
                        <span class="block text-sm text-gray-400">$${item.precio.toFixed(2)}</span>
                    `;
                    btn.onclick = () => addItemAlCarrito(item);
                    return btn;
                };

                INVENTARIO.comidas.forEach(item => comidasContainer.appendChild(crearBotonItem(item)));
                INVENTARIO.sinAlcohol.forEach(item => sinAlcoholContainer.appendChild(crearBotonItem(item)));
                INVENTARIO.conAlcohol.forEach(item => conAlcoholContainer.appendChild(crearBotonItem(item)));
            }
            
            // --- Event Listeners de Navegación ---
            mobileMenuBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
            
            logoBtn.addEventListener('click', () => {
                mostrarPaginaPublica();
            });

            // Botones que llevan al Login
            showLoginBtn.addEventListener('click', mostrarLogin);
            enterAppBtn.addEventListener('click', mostrarLogin); // Nuevo botón
            
            cancelLoginBtn.addEventListener('click', () => {
                mostrarPaginaPublica();
            });

            logoutFromTablesBtn.addEventListener('click', () => {
                mostrarPaginaPublica();
            });

            logoutBtn.addEventListener('click', () => {
                // En una app real, esto debería preguntar "Estás seguro?"
                // Por ahora, solo simula que la mesa se libera
                if (mesaActual) {
                    estadoMesas[mesaActual].estado = 'libre';
                    estadoMesas[mesaActual].carrito = [];
                    estadoMesas[mesaActual].consumo = [];
                    mesaActual = null;
                }
                mostrarPaginaPublica();
            });
            
            // --- Lógica de Simulación de Login ---
            googleLoginBtn.addEventListener('click', () => {
                // Simulación: El login fue exitoso
                console.log("Simulando login con Google...");
                mostrarSeleccionMesa();
            });
            
            // --- Lógica de Selección de Mesa ---
            function actualizarVistaMesas() {
                tableGrid.innerHTML = ''; // Limpiar la grilla
                let mesasLibres = 0;

                for (let i = 1; i <= 12; i++) {
                    const mesa = estadoMesas[i];
                    const btnMesa = document.createElement('button');
                    btnMesa.className = 'table-box p-6 rounded-lg font-bold text-2xl';
                    btnMesa.textContent = `Mesa ${i}`;
                    
                    if (mesa.estado === 'libre') {
                        btnMesa.classList.add('bg-green-600', 'hover:bg-green-500');
                        btnMesa.onclick = () => reservarMesaYMostrarQR(i); // MODIFICADO
                        mesasLibres++;
                    } else {
                        btnMesa.classList.add('bg-red-800', 'cursor-not-allowed', 'opacity-50');
                        btnMesa.disabled = true;
                    }
                    tableGrid.appendChild(btnMesa);
                }

                // Mostrar mensaje si no hay mesas
                if (mesasLibres === 0) {
                    tablesFullMsg.classList.remove('hidden');
                } else {
                    tablesFullMsg.classList.add('hidden');
                }
            }

            // --- NUEVO: Lógica del QR de Entrada ---
            atTableBtn.addEventListener('click', () => {
                mostrarAppDePedidos();
            });

            logoutFromQrBtn.addEventListener('click', () => {
                // Liberar la mesa que se había reservado
                if (mesaActual) {
                    estadoMesas[mesaActual].estado = 'libre';
                    mesaActual = null;
                }
                mostrarPaginaPublica();
            });


            // --- Lógica de la App de Pedidos ---

            function addItemAlCarrito(item) {
                if (!mesaActual) return;
                estadoMesas[mesaActual].carrito.push(item);
                actualizarVistaCarrito();
            }

            function actualizarVistaCarrito() {
                const carrito = estadoMesas[mesaActual].carrito;
                listaCarrito.innerHTML = '';
                let total = 0;

                if (carrito.length === 0) {
                    listaCarrito.appendChild(carritoVacio);
                    carritoVacio.classList.remove('hidden');
                    confirmarPedidoBtn.disabled = true;
                } else {
                    carritoVacio.classList.add('hidden');
                    carrito.forEach((item, index) => {
                        const div = document.createElement('div');
                        div.className = 'flex justify-between items-center';
                        div.innerHTML = `
                            <span>${item.nombre}</span>
                            <span class="font-semibold">$${item.precio.toFixed(2)}</span>
                        `;
                        listaCarrito.appendChild(div);
                        total += item.precio;
                    });
                    confirmarPedidoBtn.disabled = false;
                }
                totalCarrito.textContent = `$${total.toFixed(2)}`;
            }

            confirmarPedidoBtn.addEventListener('click', () => {
                if (!mesaActual) return;
                
                // Mover items del carrito al consumo
                const carrito = estadoMesas[mesaActual].carrito;
                estadoMesas[mesaActual].consumo.push(...carrito);
                estadoMesas[mesaActual].carrito = []; // Vaciar carrito

                // Actualizar ambas vistas
                actualizarVistaCarrito();
                actualizarVistaConsumo();
            });

            function actualizarVistaConsumo() {
                const consumo = estadoMesas[mesaActual].consumo;
                listaConsumoTotal.innerHTML = '';
                let total = 0;

                if (consumo.length === 0) {
                    listaConsumoTotal.appendChild(consumoVacio);
                    consumoVacio.classList.remove('hidden');
                    pagarBtn.disabled = true;
                } else {
                    consumoVacio.classList.add('hidden');
                    // Agrupar items para no mostrar una lista gigante
                    const agrupado = {};
                    consumo.forEach(item => {
                        if (!agrupado[item.nombre]) {
                            agrupado[item.nombre] = { ...item, cantidad: 0 };
                        }
                        agrupado[item.nombre].cantidad++;
                        total += item.precio;
                    });

                    Object.values(agrupado).forEach(item => {
                        const div = document.createElement('div');
                        div.className = 'flex justify-between items-center';
                        div.innerHTML = `
                            <span>${item.cantidad}x ${item.nombre}</span>
                            <span class="font-semibold">$${(item.precio * item.cantidad).toFixed(2)}</span>
                        `;
                        listaConsumoTotal.appendChild(div);
                    });
                    pagarBtn.disabled = false;
                }
                totalConsumo.textContent = `$${total.toFixed(2)}`;
                paymentTotal.textContent = `$${total.toFixed(2)}`;
            }
            
            // --- Lógica de Pago ---
            pagarBtn.addEventListener('click', () => {
                paymentScreen.classList.remove('hidden');
            });

            cancelPaymentBtn.addEventListener('click', () => {
                paymentScreen.classList.add('hidden');
            });

            // --- INICIAR LA APP ---
            inicializarEstadoMesas();
            poblarInventario();
            mostrarPaginaPublica(); // Empezar en la página pública
        });
    </script>

</body>
</html>
